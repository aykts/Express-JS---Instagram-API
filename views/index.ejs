<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Ana sayfa</title>
    <link rel="stylesheet" href="/public/css/output.css">
    <link rel="stylesheet" href="/public/css/fonts.css">
</head>
<body class="h-screen font-sans login overflow-hidden">

    <%if (typeof error_description != 'undefined') { %>
        <div class="bg-indigo-900 text-center py-4 lg:px-4">
            <div class="p-2 bg-indigo-800 items-center text-indigo-100 leading-none lg:rounded-full flex lg:inline-flex" role="alert">
                <span class="flex rounded-full bg-indigo-500 uppercase px-2 py-1 text-xs font-bold mr-3">Hata!</span>
                <span class="font-normal mr-2 text-left flex-auto">Hesabınız bağlanamadı! Detay : <%= error_description %> </span>
                <a href="/" class="pr-1">
                    <span class="icon-057"></span>
                </a>
            </div>
        </div>
    <% } %>
          
    <div class="container mx-auto h-full flex justify-center items-center">
        <div class="w-4/6 ml-auto mr-auto flex content-center">
            
            <% if(access_token != null){ %> 
            
                <div class="w-1/3 p-2 ml-auto mr-auto py-10 px-10">
                    <div class=" overflow-hidden shadow-lg bg-white rounded-lg px-10 py-10">
                        <svg width="100%" height="100" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="lds-heart">
                            <g transform="translate(50 50)">
                                <path ng-attr-fill="{{config.color}}" d="M40.7-34.3c-9.8-9.8-25.6-9.8-35.4,0L0-29l-5.3-5.3c-9.8-9.8-25.6-9.8-35.4,0l0,0c-9.8,9.8-9.8,25.6,0,35.4l5.3,5.3L-23,18.7l23,23l23-23L35.4,6.3L40.7,1C50.4-8.8,50.4-24.6,40.7-34.3z" fill="#ff727d" transform="scale(1.07673 1.07673)">
                                    <animateTransform attributeName="transform" type="scale" calcMode="spline" values="0.9859999999999999;1.16;0.8699999999999999;1.044;0.9859999999999999;0.9279999999999999" keyTimes="0;0.05;0.39;0.45;0.6;1" dur="1s" keySplines="0.215 0.61,0.355 1;0.215 0.61,0.355 1;0.215 0.61,0.355 1;0.215 0.61,0.355 1;0.215 0.61,0.355 1" begin="0s" repeatCount="indefinite"></animateTransform>
                                </path>
                            </g>
                        </svg>
                    </div>
                    <div class="text-center py-3 px-3 text-white text-xs">
                        Yükleniyor..
                    </div>
                </div>

                <script> 
                
                    var xhr = new XMLHttpRequest(); 
                    
                    xhr.open("GET","/getProfil"); 
                    
                    xhr.addEventListener("load", function(e){
                        var photoList = JSON.parse(xhr.responseText); 
                        console.log(photoList); 
                    }); 
                    
                    xhr.send(); 
                
                </script>
            
            <% }else{ %>
            
                <div class="w-2/3 p-2 ml-auto mr-auto">
                    <div class=" overflow-hidden shadow-lg bg-white rounded-lg">
                        <div class="px-6 py-4 text-center">
                            <div class="text-xl mb-5">
                                Instagram hesabınızı bağlayarak en çok beğeni alan gönderinizi bulabilirsiniz.
                            </div>
                            <p class="text-gray-700 text-base">
                                <a class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-5 rounded mb-2 inline-block" id='connectInstagram' href="/getToken">
                                    <span class="icon-326"></span> instagram hesabımı bağla
                                </a>
                            </p>
                        </div>
                    </div>
                    <div class="text-right py-3 px-3 text-white text-xs">
                        Aykut ŞİMŞEK
                    </div>
                </div>

            <% } %>

        </div>
    </div>

    <script>
    
        const instagramButton = document.getElementById('connectInstagram');

        if(instagramButton){
            
            instagramButton.addEventListener('click', function(e){

                instagramButton.innerHTML = '<svg width="24" class="float-left mr-2" height="100%" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="lds-rolling"><circle cx="50" cy="50" fill="none" ng-attr-stroke="{{config.color}}" ng-attr-stroke-width="{{config.width}}" ng-attr-r="{{config.radius}}" ng-attr-stroke-dasharray="{{config.dasharray}}" stroke="#c5523f" stroke-width="10" r="35" stroke-dasharray="164.93361431346415 56.97787143782138" transform="rotate(317.915 50 50)"><animateTransform attributeName="transform" type="rotate" calcMode="linear" values="0 50 50;360 50 50" keyTimes="0;1" dur="1s" begin="0s" repeatCount="indefinite"></animateTransform></circle></svg> bağlanıyor..'
                
            });
            
        }

    </script>
</body>
</html>